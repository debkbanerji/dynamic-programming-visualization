<div class="row no-gutter loading-spinner-container" [ngClass]="{'dark-theme': isDarkTheme}" [hidden]="problemDefined">
    <mat-spinner class="page-loading-spinner"></mat-spinner>
</div>
<div class="row no-gutter" [ngClass]="{'dark-theme': isDarkTheme}" [hidden]="!problemDefined">
    <div class="col-xs-12" *ngIf="problemDefined">
        <mat-card class="main-header-card">
            <p class="main-header">
                <span
                    (click)="goHome()"
                    class="glyphicon glyphicon-circle-arrow-left home-button">
                </span>
                {{problem['name']}}
                <mat-slide-toggle
                    [(ngModel)]="isDarkTheme"
                    (change)="onDarkModeChange()"
                    class="dark-mode-toggle">
                    Dark Mode
                </mat-slide-toggle>
            </p>
        </mat-card>
    </div>
    <div id="editor-container" class="col-xs-12 col-md-6">
        <mat-card>
            <mat-card-header>
            </mat-card-header>
            <b class="section-header">Table Shape</b>
            <mat-card-content>
                <mat-form-field>
                    <!--<label for="table-shape-select">Table Shape</label>-->
                    <mat-select [(ngModel)]="solution.tableShape" id="table-shape-select">
                        <mat-option value="1d">1 Dimensional</mat-option>
                        <mat-option value="2d">2 Dimensional</mat-option>
                    </mat-select>
                </mat-form-field>
                <form>
                    <mat-form-field *ngIf="solution.tableShape === '1d'">
                        <input matInput placeholder="Table Size"
                               [(ngModel)]="solution.tableDimension1" name="tableDimension1">
                    </mat-form-field>
                    <mat-form-field *ngIf="solution.tableShape === '2d'">
                        <input matInput placeholder="Dimension 1"
                               [(ngModel)]="solution.tableDimension1" name="tableDimension1">
                    </mat-form-field>
                    <mat-form-field *ngIf="solution.tableShape === '2d'">
                        <input matInput placeholder="Dimension 2"
                               [(ngModel)]="solution.tableDimension2" name="tableDimension2">
                    </mat-form-field>
                </form>
                <!--<form *ngIf="expectDetailedSolution && providedSolution.useAuxiliaryTableWithDetailedSolution">-->
                <!--<mat-form-field *ngIf="solution.tableShape === '1d'">-->
                <!--<input matInput placeholder="Table Size"-->
                <!--[(ngModel)]="solution.auxiliaryTableDimension1" name="auxiliaryTableDimension1">-->
                <!--</mat-form-field>-->
                <!--<mat-form-field *ngIf="solution.tableShape === '2d'">-->
                <!--<input matInput placeholder="Dimension 1"-->
                <!--[(ngModel)]="solution.auxiliaryTableDimension1" name="auxiliaryTableDimension1">-->
                <!--</mat-form-field>-->
                <!--<mat-form-field *ngIf="solution.tableShape === '2d'">-->
                <!--<input matInput placeholder="Dimension 2"-->
                <!--[(ngModel)]="solution.auxiliaryTableDimension2" name="auxiliaryTableDimension2">-->
                <!--</mat-form-field>-->
                <!--</form>-->
                <p class="section-header">Solution Code</p>
                <!--A bottom up solution should always be provided, but a top down solution may also be provided-->
                <mat-form-field
                    *ngIf="problemDefined && providedSolution.returnValueTopDownCode">
                    <!--<label for="approach-select">Approach</label>-->
                    <mat-select [(ngModel)]="approach" id="approach-select"
                                (selectionChange)="makeEditorCodeEqual(approach)">
                        <mat-option value="{{approaches[0]}}">Bottom Up</mat-option>
                        <mat-option value="{{approaches[1]}}">Top Down</mat-option>
                    </mat-select>
                </mat-form-field>
                <!--<p>-->
                <!--<small>-->
                <!--<em>// Note: All providedSolution code is in Javascript-->
                <!--</em>-->
                <!--</small>-->
                <!--</p>-->
                <!--<mat-card id="code-card">-->
                <!--<mat-card-content>-->
                <p class="code" *ngIf="problemDefined">function {{camelCase(problem['name']) + '(' +
                    (objectKeys(problem['input'])).join(', ') + ') {'}}
                </p>
                <p class="code" *ngIf="solution.tableShape === '1d'">&nbsp;&nbsp;T = A table of size
                    {{solution.tableDimension1 || '?'}}</p>
                <p class="code" *ngIf="solution.tableShape === '2d'">&nbsp;&nbsp;T = A table with dimensions
                    ({{solution.tableDimension1 || '?'}}) x ({{solution.tableDimension2 || '?'}})</p>
                <p class="code"
                   *ngIf="solution.tableShape === '1d' && expectDetailedSolution && providedSolution.useAuxiliaryTableWithDetailedSolution">
                    &nbsp;&nbsp;T2 = A table of size
                    {{solution.tableDimension1 || '?'}}</p>
                <p class="code"
                   *ngIf="solution.tableShape === '2d' && expectDetailedSolution && providedSolution.useAuxiliaryTableWithDetailedSolution">
                    &nbsp;&nbsp;T2 = A table with dimensions
                    ({{solution.tableDimension1 || '?'}}) x ({{solution.tableDimension2 || '?'}})</p>
                <div [hidden]="approach === approaches[0]">
                    <div class="initialization-textarea-container">
                    <textarea class="full-width code code-editor" id="top-down-initialization-textarea"
                              title="solution.initializationCode" rows="6"></textarea>
                    </div>
                    <p class="code">
                        &nbsp;&nbsp;function getTableEntry(i<span *ngIf="solution.tableShape === '2d'">, j</span>)
                        {{'{'}}
                    </p>
                    <p class="code">&nbsp;&nbsp;&nbsp;&nbsp;if (T(i<span *ngIf="solution.tableShape === '2d'">, j</span>)
                        !== null) {{'{'}}</p>
                    <p class="code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return T(i<span
                        *ngIf="solution.tableShape === '2d'">, j</span>);</p>
                    <p class="code">&nbsp;&nbsp;&nbsp;&nbsp;{{'}'}} else {{'{'}}</p>
                    <div class="full-width" style="overflow: hidden">
                        <div class="set-next-value-container">
                            <div class="default-entry-container">
                                <span class="code">let entry = <input [(ngModel)]="solution.defaultTableEntry"
                                                                      [hidden]="!solution.useDefaultTableEntry"
                                                                      title="defaultTableEntry"
                                                                      class="input-field-small" value="">
                                </span>
                                <span *ngIf="!solution.useDefaultTableEntry">null</span>;
                                &nbsp;&nbsp;
                                <mat-checkbox [(ngModel)]="solution.useDefaultTableEntry">Set a default value
                                </mat-checkbox>
                            </div>
                            <textarea class="code full-width" id="top-down-set-next-entry-textarea"
                                      title="setNextEntryCode" rows="20"></textarea>
                            <br>
                        </div>
                    </div>
                    <p class="code text-red">
                        <small>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Warning: be sure to use
                            'let' or 'const' while initializing variables
                            <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// If you don't do this, the
                            values of variables may change after certain function calls
                        </small>
                    </p>
                    <p class="code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T(i<span *ngIf="solution.tableShape === '2d'">, j</span>)
                        = entry;</p>
                    <p class="code"
                       *ngIf="expectDetailedSolution && providedSolution.useAuxiliaryTableWithDetailedSolution">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T2(i<span
                        *ngIf="solution.tableShape === '2d'">, j</span>)
                        = secondaryEntry;</p>
                    <p class="code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return entry;</p>
                    <p class="code">&nbsp;&nbsp;&nbsp;&nbsp;{{'}'}}</p>
                    <p class="code">&nbsp;&nbsp;{{'}'}}</p>
                </div>
                <div [hidden]="approach === approaches[1]">
                    <div class="initialization-textarea-container">
                    <textarea class="full-width code code-editor"
                              id="initialization-textarea"
                              title="solution.initializationCode" rows="6"></textarea>
                    </div>
                    <p class="code">&nbsp;&nbsp;for (
                        <input [(ngModel)]="solution.for1Variable"
                               title="for1Variable"
                               class="input-field-small" value="i"> =
                        <input [(ngModel)]="solution.for1Init"
                               title="for1Init"
                               class="input-field-small" value="0">;
                        <input [(ngModel)]="solution.for1Condition"
                               title="for1Condition"
                               class="input-field-small" value="i < (TODO: Define)">;
                        <input [(ngModel)]="solution.for1Update"
                               title="for1Update"
                               class="input-field-small" value="i = i + 1">) {{'{'}}</p>
                    <p class="code" [hidden]="solution.tableShape === '1d'">&nbsp;&nbsp;&nbsp;&nbsp;for (
                        <input [(ngModel)]="solution.for2Variable"
                               title="for2Variable"
                               class="input-field-small" value="j"> =
                        <input [(ngModel)]="solution.for2Init"
                               title="for2Init"
                               class="input-field-small" value="0">;
                        <input [(ngModel)]="solution.for2Condition"
                               title="for2Condition"
                               class="input-field-small" value="j < (TODO: Define)">;
                        <input [(ngModel)]="solution.for2Update"
                               title="for2Update"
                               class="input-field-small" value="j = j + 1">) {{'{'}}</p>
                    <div>
                        <!--<span>&nbsp;&nbsp;&nbsp;&nbsp;</span>-->
                        <!--<span *ngIf="solution.tableShape === '2d'">&nbsp;&nbsp;&nbsp;&nbsp;</span>-->
                        <div class="full-width" style="overflow: hidden">
                            <div class="set-next-value-container">
                                <div class="default-entry-container">
                                    <!--<span>&nbsp;&nbsp;&nbsp;&nbsp;</span>-->
                                    <!--<span *ngIf="solution.tableShape === '2d'">&nbsp;&nbsp;&nbsp;&nbsp;</span>-->
                                    <!--<span *ngIf="!useDefaultTableEntry">// </span>-->
                                    <span class="code">let entry = <input [(ngModel)]="solution.defaultTableEntry"
                                                                          [hidden]="!solution.useDefaultTableEntry"
                                                                          title="defaultTableEntry"
                                                                          class="input-field-small" value="">
                                </span>
                                    <span *ngIf="!solution.useDefaultTableEntry">null</span>;
                                    &nbsp;&nbsp;
                                    <mat-checkbox [(ngModel)]="solution.useDefaultTableEntry">Set a default value
                                    </mat-checkbox>
                                    <!--<input type="checkbox" [(ngModel)]="useDefaultTableEntry"-->
                                    <!--title="useDefaultTableEntry"> Use default value-->
                                </div>
                                <!--<textarea spellcheck="false" id="set-next-value-textarea" class="code"-->
                                <!--[(ngModel)]="solution.setNextEntryCode"-->
                                <!--title="setNextValueCode" rows="20"></textarea>-->
                                <textarea class="code full-width" id="set-next-entry-textarea"
                                          title="setNextEntryCode" rows="20"></textarea>
                                <!--<span>&nbsp;&nbsp;&nbsp;&nbsp;</span>-->
                                <!--<span *ngIf="solution.tableShape === '2d'">&nbsp;&nbsp;&nbsp;&nbsp;</span>-->
                                <br>
                                <span class="code">T<span *ngIf="solution.tableShape === '2d'"></span>(<input
                                    [(ngModel)]="solution.nextEntryIndex1"
                                    title="nextEntryIndex1"
                                    class="input-field-small"
                                    value="i"><span
                                    [hidden]="solution.tableShape === '1d'">,<input
                                    [(ngModel)]="solution.nextEntryIndex2"
                                    title="nextEntryIndex2"
                                    class="input-field-small"
                                    value="j"></span>) = entry;</span>
                                <p class="code"
                                   *ngIf="expectDetailedSolution && providedSolution.useAuxiliaryTableWithDetailedSolution">
                                    T2({{solution.nextEntryIndex1}}<span
                                    *ngIf="solution.tableShape === '2d'">, {{solution.nextEntryIndex2}}</span>)
                                    = secondaryEntry;</p>
                            </div>
                        </div>
                    </div>
                    <p class="code" [hidden]="solution.tableShape === '1d'">&nbsp;&nbsp;&nbsp;&nbsp;{{'}'}}</p>
                    <p class="code">&nbsp;&nbsp;{{'}'}}</p>
                    <!--<textarea spellcheck="false" id="return-value-textarea" class="code"-->
                    <!--[(ngModel)]="solution.returnValueCode"-->
                    <!--title="returnValueCode" rows="6"></textarea>-->
                </div>
                <div id="return-value-textarea-outer-container">
                    <div id="return-value-textarea-container">
                        <textarea class="full-width code code-editor" id="return-value-textarea"
                                  title="solution.returnValueCode" rows="6"></textarea>
                    </div>
                </div>
                <p class="code">&nbsp;return {{expectDetailedSolution ? '(result, solution)' : 'result'}};</p>
                <!--<p class="code">return answer;</p>-->
                <p class="code">}</p>
                <!--</mat-card-content>-->
                <!--</mat-card>-->
                <br>
                <div *ngIf="!testsCurrentlyRunning">
                    <!--<button mat-raised-button-->
                    <!--(click)="runAllTestsWithUserSolution()">-->
                    <!--Generate Code and Run Tests-->
                    <!--</button>-->
                    <button mat-fab (click)="runAllTestsWithUserSolution()">
                        <span class="glyphicon glyphicon-play run-tests-button"></span>
                    </button>
                    <button mat-button id="reveal-solution-button"
                            (click)="openPopulateGivenSolutionDialog()">
                        Show Solution
                    </button>
                </div>
                <div *ngIf="testsCurrentlyRunning">
                    <br>
                    <span>Running {{testCases.length}} tests...</span>
                    <mat-progress-bar
                        *ngIf="!testsCurrentlyRunningForProvided"
                        mode="buffer"
                        [value]="100 * numRunTestCases / testCases.length"
                        [bufferValue]="100 * min((numRunTestCases + 1), testCases.length) / testCases.length"
                        color="primary">
                    </mat-progress-bar>
                    <mat-progress-bar
                        *ngIf="testsCurrentlyRunningForProvided"
                        mode="indeterminate">
                    </mat-progress-bar>
                </div>
                <div *ngIf="!testsCurrentlyRunning && numRunTestCases > 0">
                    <br>
                    <p class="section-header">Test Results</p>
                    <b>Ran {{numRunTestCases}} test case{{numRunTestCases === 1? '' : 's'}}</b>
                    <br>
                    <b [ngClass]="{
                        'text-green': numCorrectFinalAnswerTestCases === numRunTestCases,
                        'text-yellow': numCorrectFinalAnswerTestCases < numRunTestCases
                    }"><span *ngIf="numCorrectFinalAnswerTestCases === numRunTestCases">&#x2714; </span>{{numCorrectFinalAnswerTestCases}}
                        correct final result{{numCorrectFinalAnswerTestCases === 1? '' : 's'}}</b>
                    <br>
                    <b class="text-red" *ngIf="numIncorrectFinalAnswerTestCases > 0">
                        &#x2718; {{numIncorrectFinalAnswerTestCases}} incorrect final
                        result{{numIncorrectFinalAnswerTestCases === 1? '' : 's'}}
                    </b>
                    <br *ngIf="numIncorrectFinalAnswerTestCases > 0">
                    <div *ngIf="expectDetailedSolution">
                        <b [ngClass]="{
                        'text-green': numCorrectSolutions === numRunTestCases,
                        'text-yellow': numCorrectSolutions < numRunTestCases
                    }"><span *ngIf="numCorrectSolutions === numRunTestCases">&#x2714; </span>{{numCorrectSolutions}}
                            matching solution{{numCorrectSolutions === 1? '' : 's'}}</b>
                        <br>
                        <b class="text-yellow" *ngIf="numIncorrectSolutions > 0">
                            &#x2718; {{numIncorrectSolutions}} non matching solution{{numIncorrectSolutions === 1? '' :
                            's'}}
                        </b>
                        <br *ngIf="numIncorrectSolutions > 0">
                        <span><small>Note: Depending on the problem, there may exist multiple solutions that lead to the same result</small></span>
                    </div>
                    <b class="text-red" *ngIf="numCrashedTestCases > 0">
                        &#x2718; {{numCrashedTestCases}} test{{numCrashedTestCases === 1? '' : 's'}} crashed
                    </b>
                    <br *ngIf="numCrashedTestCases > 0">
                    <b class="text-orange" *ngIf="numTimedOutTestCases > 0">
                        <span class="glyphicon glyphicon-time"></span>
                        <span class="test-result-label">{{numTimedOutTestCases}} test{{numTimedOutTestCases === 1? '' : 's'}} timed out</span>
                    </b>
                    <br *ngIf="numTimedOutTestCases > 0">
                    <b [ngClass]="{
                        'text-green': numMatchingTableDimensions === numRunTestCases,
                        'text-yellow': numMatchingTableDimensions < numRunTestCases
                    }"><span *ngIf="numMatchingTableDimensions === numRunTestCases">&#x2714; </span>{{numMatchingTableDimensions}}
                        table{{numMatchingTableDimensions === 1? '' : 's'}} with matching dimensions</b>
                    <br>
                    <b [ngClass]="{
                        'text-green': numExpectedTables === numRunTestCases,
                        'text-yellow': numExpectedTables < numRunTestCases
                    }"><span *ngIf="numExpectedTables === numRunTestCases">&#x2714; </span>{{numExpectedTables}}
                        table{{numExpectedTables === 1? '' : 's'}} with matching entries</b>
                    <br>
                    <div *ngIf="expectDetailedSolution && providedSolution.useAuxiliaryTableWithDetailedSolution">
                        <b [ngClass]="{
                            'text-green': numExpectedAuxiliaryTables === numRunTestCases,
                            'text-yellow': numExpectedAuxiliaryTables < numRunTestCases
                        }"><span *ngIf="numExpectedAuxiliaryTables === numRunTestCases">&#x2714; </span>{{numExpectedAuxiliaryTables}}
                            secondary table{{numExpectedAuxiliaryTables === 1? '' : 's'}} with matching entries</b>
                        <br>
                    </div>
                    <span><small>Note: If a top down approach was used, only non null entries of tables were checked</small></span>
                    <span
                        *ngIf="numExpectedTables < numRunTestCases && numCorrectFinalAnswerTestCases === numRunTestCases">
                        <small>This may not be an issue, since all your final results are correct.</small>
                        <br>
                        <button *ngIf="solution['tableShape'] === '2d'" mat-raised-button (click)="transposeTable()">Transpose provided table</button>
                    </span>
                </div>
                <!--<br>-->
                <!--<br>-->
                <!--<mat-expansion-panel *ngIf="generatedCode">-->
                <!--<mat-expansion-panel-header>-->
                <!--<mat-panel-title>-->
                <!--<b>Generated Code</b>-->
                <!--</mat-panel-title>-->
                <!--</mat-expansion-panel-header>-->
                <!--<div>-->
                <!--<small [innerHTML]="generatedCode"-->
                <!--class="code"></small>-->
                <!--</div>-->
                <!--</mat-expansion-panel>-->
            </mat-card-content>
        </mat-card>
    </div>
    <div id="input-and-table-container" class="col-xs-12 col-md-6" *ngIf="problemDefined">
        <mat-expansion-panel [expanded]="true">
            <mat-expansion-panel-header>
                <mat-panel-title>
                    <p class="section-header">Problem Definition</p>
                </mat-panel-title>
                <!--<mat-panel-description>-->
                <!--{{problem['name']}}-->
                <!--</mat-panel-description>-->
            </mat-expansion-panel-header>
            <div [innerHTML]="problem['problem-statement']"></div>
            <br>
            <b>
                Inputs
            </b>
            <div *ngFor="let variable of objectKeys(problem.input)">
                <span><b class="code">{{variable}}</b> : <small [innerHTML]="problem.input[variable]"></small></span>
            </div>
            <div
                *ngIf="revealedProvidedSolution">
                <br *ngIf="providedSolution['solutionNotes']">
                <div *ngIf="providedSolution['solutionNotes']">
                    <b>Solution notes</b>
                    <br>
                    <p [innerHTML]="providedSolution['solutionNotes']"></p>
                </div>
                <!--<br *ngIf="providedSolution['tableEntryDefinition']">-->
                <div *ngIf="providedSolution['tableEntryDefinition']">
                    <b>Table entry definition: </b>
                    <p [innerHTML]="providedSolution['tableEntryDefinition']"></p>
                </div>
                <div *ngIf="providedSolution['AuxiliaryTableEntryDefinition'] && expectDetailedSolution">
                    <b>Second table entry definition: </b>
                    <p [innerHTML]="providedSolution['AuxiliaryTableEntryDefinition']"></p>
                </div>
            </div>
            <div *ngIf="problem['output']['result']">
                <br>
                <b>Output</b>
                <div><b class="code">Result: </b>
                    <small [innerHTML]="problem['output']['result']"></small>
                </div>
                <div *ngIf="expectDetailedSolution"><b class="code">Solution: </b>
                    <small [innerHTML]="problem['output']['solution']"></small>
                </div>
                <div *ngIf="problem['output']['solution']">
                    <small *ngIf="expectDetailedSolution && providedSolution.useAuxiliaryTableWithDetailedSolution">
                        Note: Obtaining the full solution may require use of a second table
                    </small>
                    <br *ngIf="expectDetailedSolution && providedSolution.useAuxiliaryTableWithDetailedSolution">
                    <mat-slide-toggle [(ngModel)]="expectDetailedSolution" *ngIf="!testsCurrentlyRunning"
                                      (change)="recalculateExpectedResults(null); runAllTestsWithUserSolution();">
                        Expect full solution
                    </mat-slide-toggle>
                </div>
            </div>
        </mat-expansion-panel>
        <mat-card>
            <mat-card-content>
                <p class="section-header">Test Cases</p>
                <mat-tab-group id="test-case-group">
                    <!--<mat-tab label="Custom test case">-->
                    <!--&lt;!&ndash;TODO: Implement custom input&ndash;&gt;-->
                    <!--</mat-tab>-->
                    <mat-tab *ngFor="let testCase of testCases; let testCaseIndex = index" label="{{testCase['name']}}">
                        <mat-card>
                            <b class="slightly-bold-label">Input Values</b>
                            <br>
                            <br>
                            <mat-card-content>
                                <div *ngFor="let input of objectKeys(problem['input'])">
                                    <span class="slightly-bold-label">{{input}}:</span>
                                    <span *ngIf="!isArray(testCase['input'][input])"
                                          [innerHTML]="' ' + getDisplayedValue(testCase['input'][input])">
                                </span>
                                    <div
                                        *ngIf="isArray(testCase['input'][input]) && shouldDisplayArray(testCase['input'][input])">
                                        <!--TODO: Deal with displaying empty arrays everywhere (write a function for this)-->
                                        <table class="dp-table" *ngIf="!isRectangular2dArray(testCase['input'][input])">
                                            <tr class="dp-tr">
                                                <td class="dp-td"
                                                    *ngFor="let i of range(testCase['input'][input].length);">
                                            <span class="dp-table-cell"
                                                  [innerHTML]="getDisplayedValue(testCase['input'][input][i])">
                                            </span>
                                                </td>
                                            </tr>
                                        </table>
                                        <table class="dp-table" *ngIf="isRectangular2dArray(testCase['input'][input])">
                                            <tr class="dp-tr" *ngFor="let i of range(testCase['input'][input].length);">
                                                <td class="dp-td"
                                                    *ngFor="let j of range(testCase['input'][input][0].length);">
                                            <span class="dp-table-cell"
                                                  [innerHTML]="getDisplayedValue(testCase['input'][input][i][j])">
                                            </span>
                                                </td>
                                            </tr>
                                        </table>
                                    </div>
                                    <div
                                        *ngIf="isArray(testCase['input'][input]) && !shouldDisplayArray(testCase['input'][input])">
                                        empty Array
                                    </div>
                                </div>
                            </mat-card-content>
                        </mat-card>
                        <mat-card *ngIf="testResults[testCaseIndex] && !testsCurrentlyRunning">
                            <mat-card-content>
                                <b class="slightly-bold-label">{{testCase['name']}} Results</b>
                                <br>
                                <br>
                                <div *ngIf="testResults[testCaseIndex]['timed-out']">
                                    <b class="text-orange" style="vertical-align: middle">
                                        <span class="glyphicon glyphicon-time"></span>
                                        <span class="test-result-label"> Test timed out (took longer than {{testTimeLimit}} milliseconds)
                                        </span>
                                    </b>
                                </div>
                                <div *ngIf="testResults[testCaseIndex]['error']">
                                    <span class="text-red">
                                        <!--<mat-icon class="test-result-label">error_outline</mat-icon>-->
                                        <!--<b class="test-result-label"> Test crashed:-->
                                        <!--</b>-->
                                        <b class="test-result-label" [innerHTML]="testResults[testCaseIndex]['error']">
                                        </b>
                                    </span>
                                </div>
                                <div
                                    *ngIf="!testResults[testCaseIndex]['timed-out'] && !testResults[testCaseIndex]['error']">
                                    <div>
                                        <b class="text-green"
                                           *ngIf="testResults[testCaseIndex]['result'] === testCase['expected-result']">
                                            &#x2714; Correct Final Result
                                        </b>
                                        <b class="text-red"
                                           *ngIf="!(testResults[testCaseIndex]['result'] === testCase['expected-result'])">
                                            &#x2718; Incorrect Final Result - Expected
                                            {{getDisplayedValue(testCase['expected-result'])}}
                                            but got
                                            {{getDisplayedValue(testResults[testCaseIndex]['result'])}}
                                            {{((testResults[testCaseIndex]['result'] === null ||
                                            testResults[testCaseIndex]['result'] === undefined)
                                            && approach === approaches[1]) ? ' - Make sure you\'re using getTableEntry'
                                            + ' when accessing table entries': ''}}
                                        </b>
                                    </div>
                                    <div *ngIf="expectDetailedSolution">
                                        <!--Note: we only need to check deep equals for detailed solutions-->
                                        <b class="text-green"
                                           *ngIf="deepEquals(testResults[testCaseIndex]['solution'],testCase['expected-solution'])">
                                            &#x2714; Correct Solution
                                        </b>
                                        <div
                                            *ngIf="!(deepEquals(testResults[testCaseIndex]['solution'], testCase['expected-solution']))">
                                            <b *ngIf="!isArray(testResults[testCaseIndex]['solution'])"
                                               class="text-red">
                                                &#x2718; Incorrect Solution - Expected
                                                {{getDisplayedValue(testCase['expected-solution'])}}
                                                but got
                                                {{getDisplayedValue(testResults[testCaseIndex]['solution'])}}
                                            </b>
                                            <div *ngIf="isArray(testResults[testCaseIndex]['solution'])">
                                                <b class="text-red">&#x2718; Incorrect Solution</b>
                                                <div *ngIf="shouldDisplayArray(testResults[testCaseIndex]['solution'])">
                                                    <table class="dp-table"
                                                           *ngIf="!isRectangular2dArray(testResults[testCaseIndex]['solution'])">
                                                        <tr class="dp-tr">
                                                            <td class="dp-td"
                                                                *ngFor="let i of range(testResults[testCaseIndex]['solution'].length);">
                                                                <span class="dp-table-cell"
                                                                      [ngClass]="{'text-green': (haveEqualDimensions(testResults[testCaseIndex]['solution'], testCase['expected-solution']) &&
                                                                        testResults[testCaseIndex]['solution'][i] === testCase['expected-solution'][i]
                                                                      ),
                                                                       'text-yellow': !(haveEqualDimensions(testResults[testCaseIndex]['solution'], testCase['expected-solution']) &&
                                                                        (approach === approaches[1] ?
                                                                        testResults[testCaseIndex]['solution'][i] === testCase['expected-solution'][i] || testResults[testCaseIndex]['solution'][i] === null || testResults[testCaseIndex]['solution'][i] === undefined
                                                                         : testResults[testCaseIndex]['solution'][i] === testCase['expected-solution'][i])
                                                                      )}"
                                                                      [innerHTML]="getDisplayedValue(testResults[testCaseIndex]['solution'][i])">
                                                                </span>
                                                            </td>
                                                        </tr>
                                                    </table>
                                                    <table class="dp-table"
                                                           *ngIf="isRectangular2dArray(testResults[testCaseIndex]['solution'])">
                                                        <tr class="dp-tr"
                                                            *ngFor="let i of range(testResults[testCaseIndex]['solution'].length);">
                                                            <td class="dp-td"
                                                                *ngFor="let j of range(testResults[testCaseIndex]['solution'][0].length);">
                                                                <span class="dp-table-cell"
                                                                      [ngClass]="{'text-green': (haveEqualDimensions(testResults[testCaseIndex]['solution'], testCase['expected-solution']) &&
                                                                        testResults[testCaseIndex]['solution'][i][j] === testCase['expected-solution'][i][j]
                                                                      ),
                                                                       'text-yellow': !(haveEqualDimensions(testResults[testCaseIndex]['solution'], testCase['expected-solution']) &&
                                                                        (approach === approaches[1] ?
                                                                        testResults[testCaseIndex]['solution'][i][j] === testCase['expected-solution'][i][j] || testResults[testCaseIndex]['solution'][i][j] === null || testResults[testCaseIndex]['solution'][i][j] === undefined
                                                                         : testResults[testCaseIndex]['solution'][i][j] === testCase['expected-solution'][i][j])
                                                                      )}"
                                                                      [innerHTML]="getDisplayedValue(testResults[testCaseIndex]['solution'][i][j])">
                                                                </span>
                                                            </td>
                                                        </tr>
                                                    </table>
                                                </div>
                                                <div
                                                    *ngIf="!shouldDisplayArray(testResults[testCaseIndex]['solution'])">
                                                    Empty Array
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div>
                                        <b class="text-green"
                                           *ngIf="testResults[testCaseIndex]['has-expected-table']">
                                            &#x2714; Created expected table
                                        </b>
                                        <div
                                            *ngIf="!testResults[testCaseIndex]['has-expected-table']">
                                            <span class="text-yellow">Did not create expected table</span>
                                            <br *ngIf="!haveEqualDimensions(testResults[testCaseIndex]['table'], testCase['expected-table'])">
                                            <span class="text-yellow"
                                                  *ngIf="!haveEqualDimensions(testResults[testCaseIndex]['table'], testCase['expected-table'])">
                                                    Mismatched table dimensions: expected {{getTableDimensions(testCase['expected-table'])}} but got {{getTableDimensions(testResults[testCaseIndex]['table'])}}
                                                </span>
                                            <span
                                                *ngIf="testResults[testCaseIndex]['result'] === testCase['expected-result']">
                                                <br>
                                                Your final result is correct, but your table did not match the table generated by the provided answer.
                                                <span *ngIf="numCorrectFinalAnswerTestCases === numRunTestCases">This is likely not an issue since your solution returns the correct final result for every test case.<br></span>
                                                <span>If the expected table is just a transposed version of yours, you can <a
                                                    class="transpose-text" (click)="transposeTable()">transpose the expected table</a> to compare them.</span>
                                            </span>
                                        </div>
                                    </div>
                                    <!--<div *ngIf="!testResults[testCaseIndex]['has-expected-table']">-->
                                    <div>
                                        <div *ngIf="shouldDisplayArray(testResults[testCaseIndex]['table'])">
                                            <table class="dp-table"
                                                   *ngIf="!isRectangular2dArray(testResults[testCaseIndex]['table'])">
                                                <tr class="dp-tr">
                                                    <td class="dp-td"
                                                        *ngFor="let i of range(testResults[testCaseIndex]['table'].length);">
                                                    <span class="dp-table-cell"
                                                          [ngClass]="{'text-green': (haveEqualDimensions(testResults[testCaseIndex]['table'], testCase['expected-table']) &&
                                                            testResults[testCaseIndex]['table'][i] === testCase['expected-table'][i]
                                                          ),
                                                           'text-yellow': !(haveEqualDimensions(testResults[testCaseIndex]['table'], testCase['expected-table']) &&
                                                            (approach === approaches[1] ?
                                                            testResults[testCaseIndex]['table'][i] === testCase['expected-table'][i] || testResults[testCaseIndex]['table'][i] === null || testResults[testCaseIndex]['table'][i] === undefined
                                                             : testResults[testCaseIndex]['table'][i] === testCase['expected-table'][i])
                                                          )}"
                                                          [innerHTML]="getDisplayedValue(testResults[testCaseIndex]['table'][i])">
                                            </span>
                                                    </td>
                                                </tr>
                                            </table>
                                            <table class="dp-table"
                                                   *ngIf="isRectangular2dArray(testResults[testCaseIndex]['table'])">
                                                <tr class="dp-tr"
                                                    *ngFor="let i of range(testResults[testCaseIndex]['table'].length);">
                                                    <td class="dp-td"
                                                        *ngFor="let j of range(testResults[testCaseIndex]['table'][0].length);">
                                                    <span class="dp-table-cell"
                                                          [ngClass]="{'text-green': (haveEqualDimensions(testResults[testCaseIndex]['table'], testCase['expected-table']) &&
                                                            testResults[testCaseIndex]['table'][i][j] === testCase['expected-table'][i][j]
                                                          ),
                                                           'text-yellow': !(haveEqualDimensions(testResults[testCaseIndex]['table'], testCase['expected-table']) &&
                                                            (approach === approaches[1] ?
                                                            testResults[testCaseIndex]['table'][i][j] === testCase['expected-table'][i][j] || testResults[testCaseIndex]['table'][i][j] === null || testResults[testCaseIndex]['table'][i][j] === undefined
                                                             : testResults[testCaseIndex]['table'][i][j] === testCase['expected-table'][i][j])
                                                          )}"
                                                          [innerHTML]="getDisplayedValue(testResults[testCaseIndex]['table'][i][j])">
                                                    </span>
                                                    </td>
                                                </tr>
                                            </table>
                                        </div>
                                        <div *ngIf="!shouldDisplayArray(testResults[testCaseIndex]['table'])">
                                            Empty Table
                                        </div>
                                        <div
                                            *ngIf="expectDetailedSolution && providedSolution.useAuxiliaryTableWithDetailedSolution">
                                            <div>
                                                <b class="text-green"
                                                   *ngIf="testResults[testCaseIndex]['has-expected-auxiliary-table']">
                                                    &#x2714; Created expected second table
                                                </b>
                                                <div
                                                    *ngIf="!testResults[testCaseIndex]['has-expected-auxiliary-table']">
                                                    <span
                                                        class="text-yellow">Did not create expected second table</span>
                                                    <br *ngIf="!haveEqualDimensions(testResults[testCaseIndex]['auxiliary-table'], testCase['expected-auxiliary-table'])">
                                                    <span
                                                        *ngIf="!haveEqualDimensions(testResults[testCaseIndex]['auxiliary-table'], testCase['expected-auxiliary-table'])">
                                                        <span class="text-yellow">
                                                            Mismatched table dimensions: expected {{getTableDimensions(testCase['expected-auxiliary-table'])}} but got {{getTableDimensions(testResults[testCaseIndex]['auxiliary-table'])}}
                                                        </span>
                                                        <br>
                                                        Note that the second table has the same dimensions as the main table
                                                    </span>
                                                    <span
                                                        *ngIf="deepEquals(testResults[testCaseIndex]['solution'], testCase['expected-solution'])">
                                                        <br>
                                                        Your final solution is correct, but your second table did not match the second table generated by the provided answer.
                                                        <span *ngIf="numCorrectSolutions === numRunTestCases">This is likely not an issue since you are successfully reconstructing the correct solution for every test case.<br></span>
                                                    </span>
                                                </div>
                                            </div>
                                            <!--<div *ngIf="!testResults[testCaseIndex]['has-expected-table']">-->
                                            <div>
                                                <div
                                                    *ngIf="shouldDisplayArray(testResults[testCaseIndex]['auxiliary-table'])">
                                                    <table class="dp-table"
                                                           *ngIf="!isRectangular2dArray(testResults[testCaseIndex]['auxiliary-table'])">
                                                        <tr class="dp-tr">
                                                            <td class="dp-td"
                                                                *ngFor="let i of range(testResults[testCaseIndex]['auxiliary-table'].length);">
                                                                <span class="dp-table-cell"
                                                                      [ngClass]="{'text-green': (haveEqualDimensions(testResults[testCaseIndex]['auxiliary-table'], testCase['expected-auxiliary-table']) &&
                                                                        testResults[testCaseIndex]['auxiliary-table'][i] === testCase['expected-auxiliary-table'][i]
                                                                      ),
                                                                       'text-yellow': !(haveEqualDimensions(testResults[testCaseIndex]['auxiliary-table'], testCase['expected-auxiliary-table']) &&
                                                                        (approach === approaches[1] ?
                                                                        testResults[testCaseIndex]['auxiliary-table'][i] === testCase['expected-auxiliary-table'][i] || testResults[testCaseIndex]['auxiliary-table'][i] === null || testResults[testCaseIndex]['auxiliary-table'][i] === undefined
                                                                         : testResults[testCaseIndex]['auxiliary-table'][i] === testCase['expected-auxiliary-table'][i])
                                                                      )}"
                                                                      [innerHTML]="getDisplayedValue(testResults[testCaseIndex]['auxiliary-table'][i])">
                                                                </span>
                                                            </td>
                                                        </tr>
                                                    </table>
                                                    <table class="dp-table"
                                                           *ngIf="isRectangular2dArray(testResults[testCaseIndex]['auxiliary-table'])">
                                                        <tr class="dp-tr"
                                                            *ngFor="let i of range(testResults[testCaseIndex]['auxiliary-table'].length);">
                                                            <td class="dp-td"
                                                                *ngFor="let j of range(testResults[testCaseIndex]['auxiliary-table'][0].length);">
                                                                <span class="dp-table-cell"
                                                                      [ngClass]="{'text-green': (haveEqualDimensions(testResults[testCaseIndex]['auxiliary-table'], testCase['expected-auxiliary-table']) &&
                                                                        testResults[testCaseIndex]['auxiliary-table'][i][j] === testCase['expected-auxiliary-table'][i][j]
                                                                      ),
                                                                       'text-yellow': !(haveEqualDimensions(testResults[testCaseIndex]['auxiliary-table'], testCase['expected-auxiliary-table']) &&
                                                                        (approach === approaches[1] ?
                                                                        testResults[testCaseIndex]['auxiliary-table'][i][j] === testCase['expected-auxiliary-table'][i][j] || testResults[testCaseIndex]['auxiliary-table'][i][j] === null || testResults[testCaseIndex]['auxiliary-table'][i][j] === undefined
                                                                         : testResults[testCaseIndex]['auxiliary-table'][i][j] === testCase['expected-auxiliary-table'][i][j])
                                                                      )}"
                                                                      [innerHTML]="getDisplayedValue(testResults[testCaseIndex]['auxiliary-table'][i][j])">
                                                                </span>
                                                            </td>
                                                        </tr>
                                                    </table>
                                                </div>
                                                <div
                                                    *ngIf="!shouldDisplayArray(testResults[testCaseIndex]['auxiliary-table'])">
                                                    Empty Table
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </mat-card-content>
                        </mat-card>
                        <mat-card
                            *ngIf="testCase['expected-table'] && testCase['expected-result'] !== null && testCase['expected-result'] !== undefined">
                            <b class="slightly-bold-label">Expected {{testCase['name']}} Results<span
                                *ngIf="approach === approaches[1]"> (for bottom up algorithm)</span></b>
                            <br>
                            <br>
                            <mat-card-content>
                                <span class="slightly-bold-label">Table</span>
                                <button mat-button class="transpose-button"
                                        *ngIf="providedSolution['tableShape'] === '2d'"
                                        (click)="transposeTable()">
                                    Transpose
                                </button>
                                <div>
                                    <div *ngIf="shouldDisplayArray(testCase['expected-table'])">
                                        <table class="dp-table"
                                               *ngIf="isRectangular2dArray(testCase['expected-table'])">
                                            <tr class="dp-tr"
                                                *ngFor="let i of range(testCase['expected-table'].length);">
                                                <td class="dp-td"
                                                    *ngFor="let j of range(testCase['expected-table'][0].length);">
                                    <span class="dp-table-cell"
                                          [innerHTML]="getDisplayedValue(testCase['expected-table'][i][j])">
                                    </span>
                                                </td>
                                            </tr>
                                        </table>
                                        <table class="dp-table"
                                               *ngIf="!isRectangular2dArray(testCase['expected-table'])">
                                            <tr class="dp-tr">
                                                <td class="dp-td"
                                                    *ngFor="let i of range(testCase['expected-table'].length);">
                                    <span class="dp-table-cell"
                                          [innerHTML]="getDisplayedValue(testCase['expected-table'][i])">
                                    </span>
                                                </td>
                                            </tr>
                                        </table>
                                    </div>
                                    <div *ngIf="!shouldDisplayArray(testCase['expected-table'])">
                                        Empty Table
                                    </div>
                                </div>
                                <br>
                                <div
                                    *ngIf="expectDetailedSolution && providedSolution.useAuxiliaryTableWithDetailedSolution">
                                    <span class="slightly-bold-label">Auxiliary Table</span>
                                    <br>
                                    <div *ngIf="shouldDisplayArray(testCase['expected-auxiliary-table'])">
                                        <table class="dp-table"
                                               *ngIf="isRectangular2dArray(testCase['expected-auxiliary-table'])">
                                            <tr class="dp-tr"
                                                *ngFor="let i of range(testCase['expected-auxiliary-table'].length);">
                                                <td class="dp-td"
                                                    *ngFor="let j of range(testCase['expected-auxiliary-table'][0].length);">
                                                    <span class="dp-table-cell"
                                                          [innerHTML]="getDisplayedValue(testCase['expected-auxiliary-table'][i][j])">
                                                    </span>
                                                </td>
                                            </tr>
                                        </table>
                                        <table class="dp-table"
                                               *ngIf="!isRectangular2dArray(testCase['expected-auxiliary-table'])">
                                            <tr class="dp-tr">
                                                <td class="dp-td"
                                                    *ngFor="let i of range(testCase['expected-auxiliary-table'].length);">
                                                    <span class="dp-table-cell"
                                                          [innerHTML]="getDisplayedValue(testCase['expected-auxiliary-table'][i])">
                                                    </span>
                                                </td>
                                            </tr>
                                        </table>
                                    </div>
                                    <div *ngIf="!shouldDisplayArray(testCase['expected-auxiliary-table'])">
                                        Empty Table
                                    </div>
                                    <br>
                                </div>
                                <span class="slightly-bold-label">Final Result</span>
                                <span
                                    [innerHTML]="' ' + getDisplayedValue(testCase['expected-result'])">
                                </span>
                                <div *ngIf="expectDetailedSolution">
                                    <br>
                                    <span class="slightly-bold-label">Detailed Solution</span>
                                    <div *ngIf="!isArray(testCase['expected-solution'])">
                                        <span [innerHTML]="getDisplayedValue(testCase['expected-solution'])">
                                        </span></div>
                                    <div *ngIf="isArray(testCase['expected-solution'])">
                                        <div *ngIf="shouldDisplayArray(testCase['expected-solution'])">
                                            <table class="dp-table"
                                                   *ngIf="isRectangular2dArray(testCase['expected-solution'])">
                                                <tr class="dp-tr"
                                                    *ngFor="let i of range(testCase['expected-solution'].length);">
                                                    <td class="dp-td"
                                                        *ngFor="let j of range(testCase['expected-solution'][0].length);">
                                                        <span class="dp-table-cell"
                                                              [innerHTML]="getDisplayedValue(testCase['expected-solution'][i][j])">
                                                        </span>
                                                    </td>
                                                </tr>
                                            </table>
                                            <table class="dp-table"
                                                   *ngIf="!isRectangular2dArray(testCase['expected-solution'])">
                                                <tr class="dp-tr">
                                                    <td class="dp-td"
                                                        *ngFor="let i of range(testCase['expected-solution'].length);">
                                                        <span class="dp-table-cell"
                                                              [innerHTML]="getDisplayedValue(testCase['expected-solution'][i])">
                                                        </span>
                                                    </td>
                                                </tr>
                                            </table>
                                        </div>
                                        <div *ngIf="!shouldDisplayArray(testCase['expected-solution'])">
                                            Empty Array
                                        </div>
                                    </div>
                                </div>
                            </mat-card-content>
                        </mat-card>
                        <!--<pre>{{testCase | json}}</pre>-->
                    </mat-tab>
                </mat-tab-group>
            </mat-card-content>
        </mat-card>
    </div>
</div>
